{% extends "generic.html" %}

{% block dynamicPlots %}
  <script>
    //Global variable for range of bode plots on the x-axis
    range = JSON.parse('{{ bode_x_range_output_impedance }}');
    mags_output_impedance = JSON.parse('{{ mags_output_impedance }}');
    phases_output_impedance = JSON.parse('{{ phases_output_impedance }}');
    mags_min_output_impedance = JSON.parse('{{ mags_min_output_impedance }}');
    mags_max_output_impedance = JSON.parse('{{ mags_max_output_impedance }}');
    phase_min_output_impedance = JSON.parse('{{ phase_min_output_impedance }}');
    phase_max_output_impedance = JSON.parse('{{ phase_max_output_impedance }}');
    out_imped_mag_div = "{{ out_imped_mag_div }}";
    out_imped_phs_div = "{{ out_imped_phs_div }}";

    //Global variables for range of input impedance bode plots
    mags_input_impedance = JSON.parse('{{ mags_input_impedance }}');
    phases_input_impedance = JSON.parse('{{ phases_input_impedance }}');
    mags_min_input_impedance = JSON.parse('{{ mags_min_input_impedance }}');
    mags_max_input_impedance = JSON.parse('{{ mags_max_input_impedance }}');
    phase_min_input_impedance = JSON.parse('{{ phase_min_input_impedance }}');
    phase_max_input_impedance = JSON.parse('{{ phase_max_input_impedance }}');
    in_imped_mag_div = "{{ in_imped_mag_div }}";
    in_imped_phs_div = "{{ in_imped_phs_div }}";

    //Global variables for range of input to output transfer bode plots
    mags_input_output_transfer = JSON.parse('{{ mags_input_output_transfer }}');
    phases_input_output_transfer = JSON.parse('{{ phases_input_output_transfer }}');
    mags_min_input_output_transfer = JSON.parse('{{ mags_min_input_output_transfer }}');
    mags_max_input_output_transfer = JSON.parse('{{ mags_max_input_output_transfer }}');
    phase_min_input_output_transfer = JSON.parse('{{ phase_min_input_output_transfer }}');
    phase_max_input_output_transfer = JSON.parse('{{ phase_max_input_output_transfer }}');
    in_out_mag_div = "{{ in_out_mag_div }}";
    in_out_phs_div = "{{ in_out_phs_div }}";

    //Global variables for range of duty to output transfer bode plots
    mags_duty_output_transfer = JSON.parse('{{ mags_duty_output_transfer }}');
    phases_duty_output_transfer = JSON.parse('{{ phases_duty_output_transfer }}');
    mags_min_duty_output_transfer = JSON.parse('{{ mags_min_duty_output_transfer }}');
    mags_max_duty_output_transfer = JSON.parse('{{ mags_max_duty_output_transfer }}');
    phase_min_duty_output_transfer = JSON.parse('{{ phase_min_duty_output_transfer }}');
    phase_max_duty_output_transfer = JSON.parse('{{ phase_max_duty_output_transfer }}');
    duty_out_mag_div = "{{ duty_out_mag_div }}";
    duty_out_phs_div = "{{ duty_out_phs_div }}";
  </script>

{% endblock %}

{% block title %}
<title>{{header_title}}</title>

{% endblock %}

{% block header %}

<div id = "site-title">
    <div id="home-button" type="button"> <a href="{{landing_page_url}}">{{header_title}}</a></div>
</div>

<div id="header-support">
  <div class="right-hdr-btns"><a href="{{ ABSOLUTE_ROOT }}/{{design_center_url}}">Design Center</a></div>
  <div class="right-hdr-btns"><a href="#contact-row">Contact</a></div>
</div>

{% endblock %}

{% block left_sidebar%}
<ul>
  Power Electronics
    <!-- Loops through type of power electronic circuits.  -->
    {% for pe_type in sidebar_list[0] %}
        <!-- Sets current power electronic circuit type index. -->
        {% set pe_row = loop.index0 %}
        <li>
            <ul>
                {{ pe_type }}
                <!-- Loops through type of SMPS circuits.  -->
                {% for smps_type in sidebar_list[1][pe_row] %}
                    <!-- Sets current SMPS circuit type index. E.g. DC/DC converters -->
                    {% set smps_row = loop.index0 %}
                    <li>
                        <ul>
                            {{ smps_type }}
                            <!-- Loops through types of DC/DC circuits.  -->
                            {% for dc_type in sidebar_list[2][pe_row][smps_row] %}
                                <!-- Sets current DC/DC circuit type index. E.g. CCM -->
                                {% set dc_row = loop.index0 %}
                                <li >
                                    <ul>
                                        {{ dc_type }}
                                        <!-- Loops through DC/DC circuit names. E.g. buck-->
                                        {% for dc_type_name in sidebar_list[3][pe_row][smps_row][dc_row] %}
                                            <li>
                                                <a href="{{ ABSOLUTE_ROOT }}/{{design_center_url}}/{{dc_type_name.url}}">{{ dc_type_name }}</a>
                                            </li>
                                        {% endfor %}
                                    </ul>
                                </li>
                            {% endfor %}
                        </ul>
                    </li>
                {% endfor %}
            </ul>
        </li>
    {% endfor %}
</ul>

{% endblock %}

{% block ee_content %}
<div id="ee-content">
    <div>
        {% if analyzed_circuit_object.dcdc_type %}
            <h1>{{analyzed_circuit_object.dcdc_type}} {{ analyzed_circuit_object.name }}</h1>
        {%else%}
            <h1>THIS SHOULDN'T BE POSSIBLE.</h1>
        {% endif %}

        <div id="ee-content-picture">
            <img src="{{ static }}design_center/img/{{analyzed_circuit_object.url}}.jpg" class="rounded" alt="Picture of Circuit to be analyzed.">
        </div>

        <div id="ee-content-description">
            <h3><u>Circuit Description:</u></h3>
            <p class="left-text">{{analyzed_circuit_object.description|safe}}</p>
        </div>

        <div id="ee-content-input-params">
            <h3><u>Design Parameters:</u></h3>

            {{design_param_form.non_field_errors}}

            {% for field in design_param_form_fields %}
            
            <div class="paramWrapper">
                {{ field.errors }}
                <label for="{{ field }}" class="left-text">{{ field }}</label>
                {{ field }}
            </div>

            {% endfor %}
        </div>

        <div id="ee-content-rec-comps">
            <h3><u>Recommended Component Values:</u></h3>
        </div>

        <div id="ee-content-sel-comps">
            <h3><u>Selected Component Values:</u></h3>
        </div>

        <div id="bode-plots" class="flex">
            <div>
                <div class="black-border">
                  <h4>Duty Cycle to Output Voltage Transfer Function Bode Plots</h4>
                  <div id= {{ duty_out_mag_div }}></div>
                  <div id= {{ duty_out_phs_div }} style="margin-top: -10px;"></div>
                </div>
                <div class="black-border">
                  <h4>Output Impedance Bode Plots</h4>
                  <div id= {{ out_imped_mag_div }}></div>
                  <div id= {{ out_imped_phs_div }} style="margin-top: -10px;"></div>
                </div>
            </div>

            <div>
                <div class="black-border">
                  <h4>Input Voltage to Output Voltage Transfer Function Bode Plots</h4>
                  <div id= {{ in_out_mag_div }}></div>
                  <div id= {{ in_out_phs_div }} style="margin-top: -10px;"></div>
                </div>
                <div class="black-border">
                  <h4>Input Impedance Bode Plots</h4>
                  <div id= {{ in_imped_mag_div }}></div>
                  <div id= {{ in_imped_phs_div }} style="margin-top: -10px;"></div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block contact_row %}
<div id="contact-row-content">
    <h4>Contact me using the links below:</h4>
    <a class="btn btn-block">
      <span class="fa fa-google"></span>
      GMAIL
    </a>
    <a class="btn btn-block">
      <span class="fa fa-linkedin"></span>
      LINKEDIN
    </a>
    <a class="btn btn-block">
        <span class="fa fa-github"></span>
        GITHUB
      </a>
</div>
{% endblock %}